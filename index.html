<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cardápio</title>
  <style>
    body {
      font-family: Verdana, sans-serif;
      background-color: #eee;
      color: #333;
      margin: 1em;
      padding: 0;
    }
    header {
      background: #84716B;
      color: white;
      padding: 1.5rem;
      text-align: center;
    }
    header h2, header h3, header p {
      margin: 0.5rem 0;
    }
    main {
      padding: 1rem;
    }
    .intro {
      font-size: 1.1rem;
      margin: 1rem 0;
      text-align: center;
    }
    .categoria {
      margin-top: 2rem;
    }
    .categoria h4 {
      font-size: 1.5rem;
      color: #F12525;
      border-bottom: 1px solid #ccc;
      padding-bottom: 0.5rem;
    }
    .item {
      background-color: white;
      margin-bottom: 1rem;
      padding: 1rem;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.08);
    }
    .item label {
      display: block;
      font-weight: 600;
    }
    .quantidade {
      margin-top: 0.5rem;
      display: none;
    }
    .quantidade label {
      font-weight: normal;
      margin-right: 0.5rem;
    }
    .quantidade input {
      width: 60px;
    }
    .btn {
      display: block;
      margin: 1rem auto;
      padding: 1rem;
      font-size: 1.1rem;
      background: linear-gradient(to right, #a97451, #d4af7f);
      color: white;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      width: 90%;
      max-width: 320px;
      transition: background 0.3s;
    }
    .btn:hover {
      background: linear-gradient(to right, #d4af7f, #a97451);
    }
    #impressao {
      display: none;
      white-space: pre-wrap;
      font-size: 12px;
      margin-top: 1rem;
      background: white;
      padding: 1rem;
      border-radius: 8px;
    }
    input[type="text"] {
      width: 100%;
      padding: 0.5rem;
      margin-bottom: 1rem;
      border: 1px solid #ccc;
      border-radius: 5px;
      font-size: 1rem;
    }
    input::placeholder {
      margin-left: 10px;
    }
    .final-msg {
      text-align: center;
      margin-top: 2rem;
      font-style: italic;
      color: #444;
    }
    .total {
      text-align: center;
      font-weight: bold;
      font-size: 1.2rem;
      margin-top: 1rem;
    }
    @media print {
      body * {
        visibility: hidden;
      }
      #impressao, #impressao * {
        visibility: visible;
      }
      #impressao {
        position: absolute;
        left: 0;
        top: 0;
      }
    }
    @media (max-width: 600px) {
      .quantidade input {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <header>
    <h2>Arraial de São Francisco de Assis</h2>
    <h3>Cardápio</h3>
  </header>
  <main>
    <form id="pedidoForm">
      <input type="text" id="nomeCliente" placeholder="Digite seu nome">
      <div class="intro">Escolha o item abaixo:</div>

      <div class="categoria">
        <h4>Comidas</h4>
        <div class="item">
          <label><input type="checkbox" name="Tacacá" value="15" onchange="toggleQuantidade(this)"> Tacacá - R$ 15,00</label>
          <div class="quantidade">
            <label>Quantidade:</label>
            <input type="number" name="quant_Tacacá" min="1" value="1">
          </div>
        </div>
        <div class="item">
          <label><input type="checkbox" name="Maniçoba" value="18" onchange="toggleQuantidade(this)"> Maniçoba - R$ 18,00</label>
          <div class="quantidade">
            <label>Quantidade:</label>
            <input type="number" name="quant_Maniçoba" min="1" value="1">
          </div>
        </div>
        <div class="item">
          <label><input type="checkbox" name="Vatapá" value="12" onchange="toggleQuantidade(this)"> Vatapá - R$ 12,00</label>
          <div class="quantidade">
            <label>Quantidade:</label>
            <input type="number" name="quant_Vatapá" min="1" value="1">
          </div>
        </div>
      </div>

      <div class="categoria">
        <h4>Bebidas</h4>
        <div class="item">
          <label><input type="checkbox" name="Suco Natural" value="6" onchange="toggleQuantidade(this)"> Suco Natural - R$ 6,00</label>
          <div class="quantidade">
            <label>Quantidade:</label>
            <input type="number" name="quant_Suco Natural" min="1" value="1">
          </div>
        </div>
        <div class="item">
          <label><input type="checkbox" name="Refrigerante" value="5" onchange="toggleQuantidade(this)"> Refrigerante - R$ 5,00</label>
          <div class="quantidade">
            <label>Quantidade:</label>
            <input type="number" name="quant_Refrigerante" min="1" value="1">
          </div>
        </div>
      </div>

      <div class="categoria">
        <h4>Doces</h4>
        <div class="item">
          <label><input type="checkbox" name="Pudim" value="7" onchange="toggleQuantidade(this)"> Pudim - R$ 7,00</label>
          <div class="quantidade">
            <label>Quantidade:</label>
            <input type="number" name="quant_Pudim" min="1" value="1">
          </div>
        </div>
        <div class="item">
          <label><input type="checkbox" name="Bolo de macaxeira" value="8" onchange="toggleQuantidade(this)"> Bolo de macaxeira - R$ 8,00</label>
          <div class="quantidade">
            <label>Quantidade:</label>
            <input type="number" name="quant_Bolo de macaxeira" min="1" value="1">
          </div>
        </div>
      </div>

      <div class="total" id="totalPedido">Total: R$ 0,00</div>

      <button type="button" class="btn" onclick="enviarPedido()">Enviar Pedido via WhatsApp</button>
      <button type="button" class="btn" onclick="imprimirPedido()">Imprimir Pedido</button>
    </form>

    <div class="final-msg">Retire seu pedido na barraca ao lado.</div>
    <div id="impressao"></div>
  </main>
  <script>
    function toggleQuantidade(checkbox) {
      const quantidadeDiv = checkbox.closest('.item').querySelector('.quantidade');
      quantidadeDiv.style.display = checkbox.checked ? 'block' : 'none';
      calcularTotal();
    }

    document.querySelectorAll("input[type='number']").forEach(input => {
      input.addEventListener('input', calcularTotal);
    });

    function calcularTotal() {
      const form = document.getElementById('pedidoForm');
      let total = 0;

      for (const checkbox of form.querySelectorAll('input[type="checkbox"]')) {
        if (checkbox.checked) {
          const preco = parseFloat(checkbox.value);
          const quantidade = parseInt(form.querySelector(`input[name='quant_${checkbox.name}']`).value) || 1;
          total += preco * quantidade;
        }
      }
      document.getElementById("totalPedido").innerText = `Total: R$ ${total.toFixed(2).replace('.', ',')}`;
    }

    function enviarPedido() {
      const form = document.getElementById('pedidoForm');
      let nome = document.getElementById('nomeCliente').value.trim();
      let mensagem = '*Pedido - Arraial de São Francisco de Assis*%0A';
      if (nome) mensagem += `Cliente: ${nome}%0A`;
      let total = 0;
      let temPedido = false;

      for (const checkbox of form.querySelectorAll('input[type="checkbox"]')) {
        if (checkbox.checked) {
          const nomeItem = checkbox.name;
          const preco = parseFloat(checkbox.value);
          const quantidade = form.querySelector(`input[name='quant_${nomeItem}']`).value;
          const subtotal = preco * quantidade;
          mensagem += `- ${nomeItem}: ${quantidade} (R$ ${subtotal.toFixed(2).replace('.', ',')})%0A`;
          total += subtotal;
          temPedido = true;
        }
      }

      if (!temPedido) {
        alert("Escolha pelo menos um item antes de enviar o pedido.");
        return;
      }

      mensagem += `Total: R$ ${total.toFixed(2).replace('.', ',')}`;

      const numero = '5591980499217';
      const url = `https://wa.me/${numero}?text=${mensagem}`;
      window.open(url, '_blank');
    }

    function imprimirPedido() {
      const form = document.getElementById('pedidoForm');
      let nome = document.getElementById('nomeCliente').value.trim();
      let texto = "Arraial de São Francisco de Assis\nCardápio\nRetire na barraca ao lado\n-------------------------\n";
      if (nome) texto += `Cliente: ${nome}\n`;
      let total = 0;
      let temPedido = false;

      for (const checkbox of form.querySelectorAll('input[type="checkbox"]')) {
        if (checkbox.checked) {
          const nomeItem = checkbox.name;
          const preco = parseFloat(checkbox.value);
          const quantidade = form.querySelector(`input[name='quant_${nomeItem}']`).value;
          const subtotal = preco * quantidade;
          texto += `${nomeItem}: ${quantidade} (R$ ${subtotal.toFixed(2).replace('.', ',')})\n`;
          total += subtotal;
          temPedido = true;
        }
      }

      if (!temPedido) {
        alert("Escolha pelo menos um item antes de imprimir o pedido.");
        return;
      }

      texto += `-------------------------\nTotal: R$ ${total.toFixed(2).replace('.', ',')}\nHorário: ` + new Date().toLocaleTimeString();
      document.getElementById("impressao").innerText = texto;
      document.getElementById("impressao").style.display = "block";
      window.print();
    }
  </script>
</body>
</html>
